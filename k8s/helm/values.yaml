# Default values for kwavers-pinn Helm chart
# This is a YAML-formatted file.
# Declare variables to be passed into your templates.

# PINN API configuration
api:
  replicaCount: 3
  image:
    repository: kwavers/pinn-api
    tag: "latest"
    pullPolicy: IfNotPresent
  port: 8080
  resources:
    requests:
      memory: "2Gi"
      cpu: "1000m"
      nvidia.com/gpu: 1
    limits:
      memory: "8Gi"
      cpu: "4000m"
      nvidia.com/gpu: 1
  nodeSelector:
    nvidia.com/gpu.present: "true"
  tolerations:
    - key: "nvidia.com/gpu"
      operator: "Exists"
      effect: "NoSchedule"
  affinity:
    nodeAffinity:
      requiredDuringSchedulingIgnoredDuringExecution:
        nodeSelectorTerms:
        - matchExpressions:
          - key: nvidia.com/gpu.present
            operator: In
            values:
            - "true"

# External dependencies
postgresql:
  enabled: true
  auth:
    postgresPassword: "pinn-postgres-password"
    username: "pinn_user"
    password: "pinn_password"
    database: "pinn_db"
  architecture: standalone
  primary:
    persistence:
      enabled: true
      size: 50Gi

redis:
  enabled: true
  auth:
    password: "pinn-redis-password"
  architecture: standalone
  master:
    persistence:
      enabled: true
      size: 10Gi

# Monitoring stack
monitoring:
  enabled: true

prometheus:
  enabled: true
  server:
    persistentVolume:
      enabled: true
      size: 50Gi
    retention: "30d"

grafana:
  enabled: true
  adminPassword: "admin"
  persistence:
    enabled: true
    size: 10Gi

# Ingress configuration
ingress:
  enabled: true
  className: "nginx"
  annotations:
    nginx.ingress.kubernetes.io/ssl-redirect: "true"
    cert-manager.io/cluster-issuer: "letsencrypt-prod"
  hosts:
    - host: api.pinn.kwavers.com
      paths:
        - path: /
          pathType: Prefix
  tls:
    - secretName: pinn-api-tls
      hosts:
        - api.pinn.kwavers.com

# Horizontal Pod Autoscaler
autoscaling:
  enabled: true
  minReplicas: 3
  maxReplicas: 10
  targetCPUUtilizationPercentage: 70
  targetMemoryUtilizationPercentage: 80

# Security configuration
security:
  jwtSecret: "your-super-secret-jwt-key-change-in-production"
  apiKeys:
    enabled: true
    # Define API keys in secrets or external secret management

# Logging configuration
logging:
  level: "info"
  format: "json"

# Rate limiting
rateLimiting:
  anonymousRPM: 60
  authenticatedRPM: 600
  burstAllowance: 10

# Database configuration
database:
  host: ""
  port: 5432
  name: "pinn_db"
  sslMode: "require"

# Redis configuration
cache:
  host: ""
  port: 6379
  password: ""

# Service configuration
service:
  type: ClusterIP
  port: 80
  targetPort: 8080

# ConfigMap for application configuration
config:
  api:
    bindAddress: "0.0.0.0"
    port: 8080
    requestTimeout: 300
    maxBodySize: 10485760
  monitoring:
    prometheusEndpoint: "/metrics"
    healthCheckEndpoint: "/health"
